{% extends 'base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">

<style>
    .dataTables_filter {
        margin-bottom: 15px;
    }

    .dataTables_length {
        margin-bottom: 15px;
    }
</style>
{% endblock %}

{% block content %}

<div class="col-12">
  <div class="card">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="card-title mb-0">Assigned Users</h4>
      </div>

      <div class="table-responsive">
        <table id="usersTable" class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Sl.No</th>
              <th>First Name</th>
              <th>Last Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Assigned Admin</th>
            </tr>
          </thead>
          <tbody>
            {% for user in assigned_users %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td>{{ user.first_name }}</td>
              <td>{{ user.last_name }}</td>
              <td>{{ user.email }}</td>
              <td>{{ user.get_role_display }}</td>
              <td>
                {% if user.assigned_admin %}
                    {{ user.assigned_admin.email }}
                {% else %}
                    -
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>
</div>

{% endblock %}

{% block extra_js %}

<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(function() {
        $('#usersTable').DataTable({
            "paging": true,
            "searching": true,
            "ordering": true,
            "order": [[0, "asc"]],
            "lengthMenu": [5, 10, 25, 50],
            "pageLength": 10,
            "columnDefs": [
                { "searchable": false, "targets": [4, 5] },
                { "orderable": false, "targets": [4, 5] }
            ]
        });
    });
</script>

{% endblock %}
